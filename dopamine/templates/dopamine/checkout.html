{% extends 'dopamine/base.html' %}
{% load static %}
{% block content %}
<link href="{% static 'dopamine/css/checkout.css' %}" rel="stylesheet"/> 

<div class="container mt-5 pt-3">
  <div class="row">
    
    <!-- THÔNG TIN NGƯỜI DÙNG -->
    <div class="col-md-6">
      <div class="box-element">
        <h4 class="mb-3">Thông tin người đặt</h4>
        <form method="POST" action="{% url 'checkout' %}">
          {% csrf_token %}
          <div class="form-group mb-2">
            <label>Họ và Tên</label>
            <input required class="form-control" type="text" name="name" placeholder=" ">
          </div>
          <div class="form-group mb-2">
            <label>Email</label>
            <input required class="form-control" type="email" name="email" placeholder=" ">
          </div>
		  <div class="form-group mb-2">
			<label>Số điện thoại</label>
            <input class="form-control" type="text" name="phone" placeholder=" " required>
          </div>
          <hr>
          <h5>Địa chỉ giao hàng</h5>
          <div class="form-group mb-2">
			<label>Tỉnh/Thành phố</label>
            <input class="form-control" type="text" name="address" placeholder=" ">
          </div>
          <div class="form-group mb-2">
			<label>Phường/Xã</label>
            <input class="form-control" type="text" name="state" placeholder=" ">
          </div>
		  <div class="form-group mb-2">
			<label>Tên đường, tòa nhà, số nhà</label>
            <input class="form-control" type="text" name="state" placeholder=" ">
          </div>
          <!-- ⚠️ Loại bỏ dòng: Zipcode -->
		{% comment %} <div class="form-group mb-2">
		  <input class="form-control" type="text" name="country" placeholder="Quốc gia (nếu cần)">
		</div> {% endcomment %}
		
          <hr>
          <h5>Phương thức thanh toán</h5>
          <select name="payment_method" class="form-control mb-3" required>
            <option value="cod">Thanh toán khi nhận hàng (COD)</option>
            <option value="bank">Chuyển khoản ngân hàng</option>
            <option value="momo">Momo</option>
          </select>

          <button type="submit" class="btn btn-success w-100 mt-3">Xác nhận đặt hàng</button>
        </form>
      </div>
    </div>

   <!-- TÓM TẮT ĐƠN HÀNG -->
    <div class="col-md-6">
      <div class="box-element">
        <h4>Tóm tắt đơn hàng</h4>
        <hr>
        {% for item in items %}
          {% if item.product %}
            <div class="cart-row mb-2 d-flex align-items-center">
              <div style="flex:2"><img class="row-image" src="{{ item.product.ImageProduct }}"></div>
              <div style="flex:3">{{ item.product.name }}</div>
              <div style="flex:1">{{ item.product.price }}đ</div>
              <div style="flex:1">x {{ item.quantity }}</div>
            </div>
          {% endif %}
        {% endfor %}
        <hr>
        <h5>Tổng số lượng: {{ order.get_cart_items }}</h5>
        <h5>Tổng tiền: {{ order.get_cart_total }}đ</h5>
        <a href="{% url 'cart' %}" class="btn btn-outline-dark mt-3">← Quay lại giỏ hàng</a>
      </div>
    </div>

  </div>
</div>
{% endblock content %}
